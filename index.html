<html>
<head>
    <style type="text/css">
        #board_container {
            text-align:center;
        }
        .block {
            border: 1px solid slategray;
            width: 30px;
            height: 30px;
            display: inline-block;
            font-size: 8px;
            color: white;
            background-color: black;
        }
        .orange {
            background-color: orange;
        }
        .cyan {
            background-color: cyan;
        }
        .lime {
            background-color: lime;
        }
        .purple {
            background-color: purple;
        }
        .blue {
            background-color: blue;
        }
        .red {
            background-color: red;
        }
        .yellow {
            background-color: yellow;
        }
    </style>
</head>
<body>
<div id="board_container">Loading...</div>

<script type="application/javascript">
    ROWS = 20;
    COLS = 10;
    count = 0;

    //i,j,l,s,z,t,o
    tetraminoI = {
        shape: [[0,0],[1,0],[2,0],[3,0]],
        color: "cyan"
    };
    tetraminoJ = {
        shape: [[0,1],[1,1],[2,1],[2,0]],
        color: "blue"
    };
    tetraminoL = {
        shape: [[0,0],[1,0],[2,0],[2,1]],
        color: "orange"
    };
    tetraminoS = {
        shape: [[1,0],[1,1],[0,1],[0,2]],
        color: "lime"
    };
    tetraminoZ = {
        shape: [[0,0],[0,1],[1,1],[1,2]],
        color: "red"
    };
    tetraminoT = {
        shape: [[0,0],[0,1],[0,2],[1,1]],
        color: "purple"
    };
    tetraminoO = {
        shape: [[0,0],[0,1],[1,0],[1,1]],
        color: "yellow"
    };

    currentTetramino = createTetramino();
    linecount = 0;
    board = null;

    function createTetramino() {
        tetraminos = [tetraminoJ,tetraminoL,tetraminoI,tetraminoS,tetraminoZ,tetraminoO,tetraminoT];
        var rand = Math.floor(Math.random() * tetraminos.length);
        return tetraminos[rand];
    }

    function createBoard(rows,cols) {
        var boardID = document.getElementById("board_container");
        var content = "";
        board = [];

        for(var row = 0; row <= rows; row++) {
            content = content + "<div>";
            board[row] = [];
            for(var col = 0; col <= cols; col++) {
                board[row][col] = false;
                content = content + "<div id='block_" + row + "_" + col + "' class='block'>" + row + ", " + col + "</div>"
            }
            content = content + "</div>";
        }
        boardID.innerHTML = content;
    }

    function draw(tetramino,count) {
        for(var i = 0; i < tetramino.shape.length; i++) {
            x = (tetramino.shape[i][0]) + count;
            y = tetramino.shape[i][1];
            blockid = "block_" + x + "_" + y;
            classname = "block active " + tetramino.color;
            board[x][y] = true;
            document.getElementById(blockid).setAttribute("class", classname);
        }
        return x;
    }

    function empty(tetramino,count) {
        for(var i = 0; i < tetramino.shape.length; i++) {
            x = (tetramino.shape[i][0]) + count;
            y = tetramino.shape[i][1];
            blockid = "block_" + x + "_" + y;
            board[x][y] = false;
            classname = "block active black";
            document.getElementById(blockid).setAttribute("class", classname);
        }
    }

    function drop() {
        if (linecount < ROWS) {
            if (count == 0) {
                linecount = draw(currentTetramino,count);
            } else {
                empty(currentTetramino, count-1);
                linecount = draw(currentTetramino,count);
            }
            count += 1;
        } else {
            count = 0;
            linecount = 0;
            currentTetramino = createTetramino();
        }
    }

    function createGame() {
        var start = window.setInterval(drop, 100);
    }

    createBoard(ROWS,COLS);
    createGame();

</script>

</body>
</html>